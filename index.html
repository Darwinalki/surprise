const btn = document.getElementById("btnSuivant");
let unlocked = false;

// Bloque mobile (optionnel pour desktop)
if (/Mobi|Android|iPhone/i.test(navigator.userAgent)) {
  document.body.innerHTML = document.getElementById("messageMobile").outerHTML;
}

// Position initiale
btn.style.top = "70%";
btn.style.left = "45%";

// Bouton qui fuit
document.addEventListener("mousemove", function(e) {
  if (unlocked) return;
  const rect = btn.getBoundingClientRect();
  const dist = Math.hypot(e.clientX - rect.left, e.clientY - rect.top);
  if (dist < 120) {
    btn.style.left = Math.random() * (window.innerWidth - btn.offsetWidth) + "px";
    btn.style.top = Math.random() * (window.innerHeight - btn.offsetHeight) + "px";
  }
});

// Ouvre popup
document.addEventListener("click", function(e) {
  if (!unlocked && e.target.id !== "reponse" && e.target.id !== "btnSuivant") {
    document.getElementById("popup").style.display = "block";
  }
});

function verifier() {
  let val = document.getElementById("reponse").value.toLowerCase().trim();
  if (val === "se filmer") {
    unlocked = true;
    document.getElementById("popup").style.display = "none";
    btn.style.background = "#4CAF50";
    btn.innerText = "Télécharger la surprise";
  } else {
    alert("Mauvaise réponse, essaye encore !");
  }
}

// Téléchargement PDF
btn.addEventListener("click", () => {
  if (unlocked) {
    const a = document.createElement("a");
    a.href = "surprise.pdf";
    a.download = "Surprise.pdf";
    a.click();
  }
});
